# Malware Sample Decryptor

A cross-platform tool for securely decrypting and extracting malware samples for analysis.

## Requirements

This script requires Python 3.6+ and one of the following crypto libraries:
- `cryptography` (preferred)
- `pycryptodome`

Install dependencies:
```bash
pip install -r requirements.txt
```

## Usage

### Basic Decryption

To decrypt a malware sample:
```bash
python3 extract.py --input encrypted.bin --output decrypted.file --secret YOUR_SECRET --checksum YOUR_CHECKSUM
```

### Decrypt and Extract

If the decrypted file is a ZIP archive containing malware samples:
```bash
python3 extract.py --input encrypted.bin --output samples.zip --extract --secret YOUR_SECRET --checksum YOUR_CHECKSUM
```

### Command-line Options

| Option | Short | Required | Description |
|--------|-------|----------|-------------|
| `--input` | `-i` | Yes | Path to the encrypted input file |
| `--output` | `-o` | Yes | Path for the decrypted output file |
| `--secret` | `-s` | Yes | Secret key used for encryption key generation |
| `--checksum` | `-c` | Yes | Checksum for verification |
| `--extract` | `-e` | No | Extract the decrypted file if it is a ZIP archive |

Use uptycs console to get the secret and checksum.

## Security Notes

- Handle decrypted malware samples with appropriate caution in a secure environment

## Examples

### Basic Usage
```bash
python3 extract.py -i /path/to/samples/malware123.bin -o /path/to/output/malware123.exe -s "abcd1234" -c "faa0deaba42ba76192609c5d2f59664e871c7bc68ebb5d99c91bf8ea4ddb8ea5"
```

### Decrypt and Extract Samples
```bash
python3 extract.py -i /path/to/samples/malware_pack.bin -o /path/to/output/malware_pack.zip -e -s "abcd1234" -c "faa0deaba42ba76192609c5d2f59664e871c7bc68ebb5d99c91bf8ea4ddb8ea5"
```

